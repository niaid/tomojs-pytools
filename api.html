<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API &#8212; tomojs-pytools  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=514cf933" />
    
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Development" href="development.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tomojs-pytools  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-pytools">
<span id="api"></span><h1>API<a class="headerlink" href="#module-pytools" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.</span></span><span class="sig-name descname"><span class="pre">HedwigZarrImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zarr_grp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_ome_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OMEInfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_ome_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.HedwigZarrImage" title="Link to this definition">¶</a></dt>
<dd><p>Represents a OME-NGFF Zarr pyramidal image. The members provide information useful for the Hedwig imaging pipelines.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pytools.HedwigZarrImage.dims" title="Link to this definition">¶</a></dt>
<dd><p>The Hedwig dimension of the image XY, XYC, XYZCT etc.</p>
<p>Collapses ZCT dimensions if of size 1.</p>
<p>Note: this is the reverse order of axis for numpy/zarr/dask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.extract_2d">
<span class="sig-name descname"><span class="pre">extract_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_size_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_uint8</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Image</span></span></span><a class="headerlink" href="#pytools.HedwigZarrImage.extract_2d" title="Link to this definition">¶</a></dt>
<dd><p>Extracts a 2D SimpleITK Image from an OME-NGFF pyramid structured with ZARR array that is 2D-like.</p>
<dl class="simple">
<dt>The OME-NGFF pyramid structured ZARR array is assumed to have the following structure:</dt><dd><ul class="simple">
<li><p>The axes spacial dimensions must be labeled as “X”, “Y”, and optionally “Z”.</p></li>
<li><p>If a “Z” space dimension exists then it must be of size 1.</p></li>
<li><p>If a time dimension exists then it must be if of size 1.</p></li>
<li><p>If a channel dimension exists all channels are extracted.</p></li>
</ul>
</dd>
</dl>
<p>The extracted subvolume will be resized to the target size while maintaining the aspect ratio.</p>
<p>The resized extracted subvolume with be the same pixel type as the OME-NGFF pyramid structured ZARR array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_size_x</strong> – The target size of the extracted subvolume in the x dimension.</p></li>
<li><p><strong>target_size_y</strong> – The target size of the extracted subvolume in the y dimension.</p></li>
<li><p><strong>size_factor</strong> – The size of the subvolume to extract will be increased by this factor so that the
extracted subvolume can have antialiasing applied to it.</p></li>
<li><p><strong>auto_uint8</strong> – If True the output image will be automatically linearly shifted and scaled to fit into uint8
component pixel types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted subvolume as a SimpleITK image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.neuroglancer_shader_parameters">
<span class="sig-name descname"><span class="pre">neuroglancer_shader_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mad_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">middle_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#pytools.HedwigZarrImage.neuroglancer_shader_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Produces the “shaderParameters” portion of the metadata for Neuroglancer.</p>
<p>Determines which shader type to use to render the image. The shader type is one of: RGB, Grayscale, or
MultiChannel. The shader parameters are computed from the full resolution Zarr image. Dask is used for parallel
reading and statistics computation. The global scheduler is used for all operations which can be changed with
standard Dask configurations.</p>
<p>For the MultiChannel shader type the default algorithm for the range is to compute the robust median absolute
deviation (MAD) about the median to produce the minimum and maximum range. If the middle_quantile is not None
then the range is computed from the provided quantiles of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mad_scale</strong> – The scale factor for the robust median absolute deviation (MAD) about the median to produce
the minimum and maximum range that is used to select the visible pixel intensities.</p></li>
<li><p><strong>middle_quantile</strong> – If not None then the range is computed from the  provided quantiles of the image data.
The middle_quantile is a tuple of two floats that are between 0.0 and 1.0. The first value is the lower
quantile and the second value is the upper quantile. The range is computed from the lower and upper quantiles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary of the shader parameters suitable for JSON serialization</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#pytools.HedwigZarrImage.path" title="Link to this definition">¶</a></dt>
<dd><p>Returns full path to the ZARR group suitable for Neuroglancer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.rechunk">
<span class="sig-name descname"><span class="pre">rechunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pytools.HedwigZarrImage.rechunk" title="Link to this definition">¶</a></dt>
<dd><p>Change the chunk size of each ZARR array inplace in the pyramid.</p>
<p>The chunk_size is applied to all spacial dimension, and other dimension (CT) are the full size.</p>
<p>The ImageZarrImage need write access to the ZARR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk_size</strong> – The size as an integer to resize the chunk sizes.</p></li>
<li><p><strong>compressor</strong> – The output arrays will be written with the provided compressor, if None then the compressor
of the input arrays will be used.</p></li>
<li><p><strong>in_memory</strong> – If true the entire arrays will be loaded into memory uncompressed, before writing to the</p></li>
</ul>
</dd>
</dl>
<p>rechunked size, otherwise the arrays will be written directly to the rechunked size. The former is faster but
requires enough memory to hold the arrays.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.shader_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shader_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pytools.HedwigZarrImage.shader_type" title="Link to this definition">¶</a></dt>
<dd><p>Produces the shader type one of: RGB, Grayscale, or MultiChannel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pytools.HedwigZarrImage.shape" title="Link to this definition">¶</a></dt>
<dd><p>The size of the dimensions of the full resolution image.</p>
<p>This is in numpy/zarr/dask order.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImage.spacing">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spacing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pytools.HedwigZarrImage.spacing" title="Link to this definition">¶</a></dt>
<dd><p>The size of the dimensions of the full resolution image.</p>
<p>This is in numpy/zarr/dask order.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytools.HedwigZarrImages">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.</span></span><span class="sig-name descname"><span class="pre">HedwigZarrImages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zarr_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.HedwigZarrImages" title="Link to this definition">¶</a></dt>
<dd><p>Represents the set of images in a OME-NGFF ZARR structure.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytools.HedwigZarrImages.get_series_keys">
<span class="sig-name descname"><span class="pre">get_series_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#pytools.HedwigZarrImages.get_series_keys" title="Link to this definition">¶</a></dt>
<dd><p>Returns an iterable of strings of the names or labels of the images. Will be extracted from
the OME-XML if available otherwise the ZARR group names.
e.g. “label_image”</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImages.ome_info">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ome_info</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AnyStr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pytools.HedwigZarrImages.ome_info" title="Link to this definition">¶</a></dt>
<dd><p>Returns OME XML as string is if exists.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytools.HedwigZarrImages.ome_xml_path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ome_xml_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pytools.HedwigZarrImages.ome_xml_path" title="Link to this definition">¶</a></dt>
<dd><p>Returns the path to the OME-XML file, if it exists.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytools.HedwigZarrImages.series">
<span class="sig-name descname"><span class="pre">series</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pytools.HedwigZarrImage" title="pytools.HedwigZarrImage.HedwigZarrImage"><span class="pre">HedwigZarrImage</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#pytools.HedwigZarrImages.series" title="Link to this definition">¶</a></dt>
<dd><p>An Iterable of key and HedwigZarrImages stored in the ZARR structure.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.visual_min_max">
<span class="sig-prename descclassname"><span class="pre">pytools.</span></span><span class="sig-name descname"><span class="pre">visual_min_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mad_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#pytools.visual_min_max" title="Link to this definition">¶</a></dt>
<dd><p>Reads a path to an input_image file or a directory of zarr array to estimate minimum and maximum ranges to be
used for visualization of the data set in Neuroglancer.</p>
<p>Dask is used for parallel reading and statistics computation. The global scheduler is used for all operations which
can be changed with standard Dask configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_image</strong> – If an image file then SimpleITK is used to perform the IO. SimpleITK support formats such as
mrc, mii, png, tiff etc.A zarr array is detected by a directory containing a “.zarray” file. For an OME-NGFF
structured  ZARR a subdirectory such as “0” commonly contains the full resolution ZARR array. Such a case would
be specified by “dirname.zarr/0”.</p></li>
<li><p><strong>mad_scale</strong> – The scale factor for the robust median absolute deviation (MAD) about the median to produce the
“minimum and maximum range.”</p></li>
<li><p><strong>clamp</strong> – If True then the minimum and maximum range will be clamped to the computed floor and limit values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting dictionary will contain the following data elements with integer values as strings:
- “neuroglancerPrecomputedMin”
- “neuroglancerPrecomputedMax”
- “neuroglancerPrecomputedFloor”
- “neuroglancerPrecomputedLimit”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.zarr_extract_2d">
<span class="sig-prename descclassname"><span class="pre">pytools.</span></span><span class="sig-name descname"><span class="pre">zarr_extract_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_zarr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Image</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#pytools.zarr_extract_2d" title="Link to this definition">¶</a></dt>
<dd><p>Extracts a 2D image from an OME-NGFF pyramid structured with ZARR array that is 2D-like.</p>
<dl class="simple">
<dt>The OME-NGFF pyramid structured ZARR array is assumed to have the following structure:</dt><dd><ul class="simple">
<li><p>The axes spacial dimensions must be labeled as “X”, “Y”, and optionally “Z”.</p></li>
<li><p>If a “Z” space dimension exists then it must be of size 1.</p></li>
<li><p>If a time dimension exists then it must be if of size 1.</p></li>
<li><p>If a channel dimension exists all channels are extracted.</p></li>
</ul>
</dd>
</dl>
<p>The extracted subvolume will be resized to the target size while maintaining the aspect ratio.</p>
<p>The resized extracted subvolume with be the sample pixel type as the OME-NGFF pyramid structured ZARR array.</p>
<p>If output_filename is not None then the extracted subvolume will be written to this file. The output ITK ImageIO
used to write the file may place additional contains on the image which can be written. Such as JPEG only supporting
uint8 pixel types and 1, 3, or 4 components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_zarr</strong> – The path to an OME-NGFF structured ZARR array.</p></li>
<li><p><strong>target_size_x</strong> – The target size of the extracted subvolume in the x dimension.</p></li>
<li><p><strong>target_size_y</strong> – The target size of the extracted subvolume in the y dimension.</p></li>
<li><p><strong>size_factor</strong> – The size of the subvolume to extract will be increased by this factor so that the
extracted subvolume can have antialiasing applied to it.</p></li>
<li><p><strong>output_filename</strong> – If not None then the extracted subvolume will be written to this file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted subvolume as a SimpleITK image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-pytools.meta">
<dt class="sig sig-object py" id="pytools.meta.is_int16">
<span class="sig-prename descclassname"><span class="pre">pytools.meta.</span></span><span class="sig-name descname"><span class="pre">is_int16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#pytools.meta.is_int16" title="Link to this definition">¶</a></dt>
<dd><p>Read an image file header to inspect meta-data.</p>
<p>Supported file formats include TIFF, and others supported by SimpleITK and the Insight toolkit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> – The path to an image file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the pixel type is a signed 16-bit integer, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-pytools.utils.zarr">
<dt class="sig sig-object py" id="pytools.utils.zarr.bin_shrink">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.zarr.</span></span><span class="sig-name descname"><span class="pre">bin_shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.zarr.bin_shrink" title="Link to this definition">¶</a></dt>
<dd><p>Reduces image by a factor of 2 in xyz and performs averaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – an array-like object of 3 dimensions</p></li>
<li><p><strong>shrink_dim</strong> – an iterable for dimensions to perform operation on. Recommended to order from the fastest axis to
slowest for performance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.zarr.build_pyramid">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.zarr.</span></span><span class="sig-name descname"><span class="pre">build_pyramid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zarr_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1,</span> <span class="pre">-2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.zarr.build_pyramid" title="Link to this definition">¶</a></dt>
<dd><p>Iteratively generate multiple resolutions of zarr arrays.</p>
<p>The input array is named by the first items in the components. The remaining components are iteratively generated by
reducing the resolution in the “shrink” dimensions, by a factor of 2.</p>
</dd></dl>

<dl class="py class" id="module-pytools.utils.histogram">
<dt class="sig sig-object py" id="pytools.utils.histogram.DaskHistogramHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">DaskHistogramHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr:</span> <span class="pre">&lt;module</span> <span class="pre">'dask.array'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/dask/array/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.histogram.DaskHistogramHelper" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytools.utils.histogram.HistogramBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">HistogramBase</span></span><a class="headerlink" href="#pytools.utils.histogram.HistogramBase" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytools.utils.histogram.ZARRHistogramHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">ZARRHistogramHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.histogram.ZARRHistogramHelper" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.histogram.histogram_robust_stats">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">histogram_robust_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.histogram.histogram_robust_stats" title="Link to this definition">¶</a></dt>
<dd><p>Computes the “median” and “mad” (Median Absolute Deviation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – The histogram weights ( density or count ).</p></li>
<li><p><strong>bin_edges</strong> – The edges of the bins. This array should be one greater than the hist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.histogram.histogram_stats">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">histogram_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.histogram.histogram_stats" title="Link to this definition">¶</a></dt>
<dd><p>Computes the “mean”, “var” (variance), and “sigma” (standard deviation) from the provided histogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – The histogram weights ( density or count ).</p></li>
<li><p><strong>bin_edges</strong> – The edges of the bins. This array should be one greater than the hist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.histogram.weighted_quantile">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.histogram.</span></span><span class="sig-name descname"><span class="pre">weighted_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.histogram.weighted_quantile" title="Link to this definition">¶</a></dt>
<dd><p>Very close to numpy.percentile, but supports weights.
NOTE: quantiles should be in [0, 1]!
:param values: numpy.array with data
:param quantiles: array-like with many quantiles needed
:param sample_weight: array-like of the same length as <cite>array</cite>
:param values_sorted: bool, if True, then will avoid sorting of
initial array
:param old_style: if True, will correct output to be consistent
with numpy.percentile.
:return: numpy.array with computed quantiles.</p>
</dd></dl>

<dl class="py function" id="module-pytools.convert">
<dt class="sig sig-object py" id="pytools.convert.file_to_uint8">
<span class="sig-prename descclassname"><span class="pre">pytools.convert.</span></span><span class="sig-name descname"><span class="pre">file_to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pytools.convert.file_to_uint8" title="Link to this definition">¶</a></dt>
<dd><p>Read an image file, scale the input pixel intensity range to 0-255, and write an image as an unsigned 8-bit integer.</p>
<p>Supported file formats include TIFF, and others supported by SimpleITK and the Insight toolkit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file_path</strong> – The file path for the source image.</p></li>
<li><p><strong>out_file_path</strong> – The file path to the output, the extension will be used to automatically determine the Image
format used. The out_file_path must be different that the input_file_path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The conversion from to uint16 is done with floating point operations with truncation rounding. This is
considered an implementation detail that may change.</p>
</div>
</dd></dl>

<span class="target" id="module-pytools.zarr_build_multiscales"><span id="module-pytools.zarr_rechunk"></span></span></section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#pytools.HedwigZarrImage"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage</span></code></a><ul>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.dims"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.dims</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.extract_2d"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.extract_2d()</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.neuroglancer_shader_parameters"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.neuroglancer_shader_parameters()</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.path"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.path</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.rechunk"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.rechunk()</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.shader_type"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.shader_type</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.shape"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.shape</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImage.spacing"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImage.spacing</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytools.HedwigZarrImages"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImages</span></code></a><ul>
<li><a class="reference internal" href="#pytools.HedwigZarrImages.get_series_keys"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImages.get_series_keys()</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImages.ome_info"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImages.ome_info</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImages.ome_xml_path"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImages.ome_xml_path</span></code></a></li>
<li><a class="reference internal" href="#pytools.HedwigZarrImages.series"><code class="docutils literal notranslate"><span class="pre">HedwigZarrImages.series()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytools.visual_min_max"><code class="docutils literal notranslate"><span class="pre">visual_min_max()</span></code></a></li>
<li><a class="reference internal" href="#pytools.zarr_extract_2d"><code class="docutils literal notranslate"><span class="pre">zarr_extract_2d()</span></code></a></li>
<li><a class="reference internal" href="#pytools.meta.is_int16"><code class="docutils literal notranslate"><span class="pre">is_int16()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.zarr.bin_shrink"><code class="docutils literal notranslate"><span class="pre">bin_shrink()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.zarr.build_pyramid"><code class="docutils literal notranslate"><span class="pre">build_pyramid()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.DaskHistogramHelper"><code class="docutils literal notranslate"><span class="pre">DaskHistogramHelper</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.HistogramBase"><code class="docutils literal notranslate"><span class="pre">HistogramBase</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.ZARRHistogramHelper"><code class="docutils literal notranslate"><span class="pre">ZARRHistogramHelper</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.histogram_robust_stats"><code class="docutils literal notranslate"><span class="pre">histogram_robust_stats()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.histogram_stats"><code class="docutils literal notranslate"><span class="pre">histogram_stats()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.histogram.weighted_quantile"><code class="docutils literal notranslate"><span class="pre">weighted_quantile()</span></code></a></li>
<li><a class="reference internal" href="#pytools.convert.file_to_uint8"><code class="docutils literal notranslate"><span class="pre">file_to_uint8()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="development.html"
                          title="previous chapter">Development</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tomojs-pytools  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2022, Bradley Lowekamp.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>